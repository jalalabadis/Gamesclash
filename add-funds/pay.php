
 <html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="icon" href="/images/favicon.ico">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0">
    <meta name="theme-color" content="#000000">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Play Games Online and Earn Money | Ludo, Cricket, Chess, Carrom Many More Game</title>
    <meta name="description" content="Not set------------" data-react-helmet="true">
    <meta name="keywords" content="Not set--------------" data-react-helmet="true">
    <meta property="og:description" content="Not Set-------------" data-react-helmet="true">
    <meta property="og:url" content="http://www.khelbro.com" data-react-helmet="true">
    <meta property="og:locale" content="en-in">
    <meta property="og:image" content="https://khelbro.com/images/khelbro-meta.jpg">
    <meta property="og:site_name" content="Not Set----------" data-react-helmet="true">
    <meta property="og:type" content="website">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:width" content="300">
    <meta property="og:image:height" content="300">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="">
    <meta name="twitter:title" content="Not Set------------" data-react-helmet="true">
    <!----------Style Part------->
    <link rel="apple-touch-icon" href="/images/logo192.png">
    <link rel="manifest" href="/js/manifest.json">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/addfound.css">
    <link rel="stylesheet" href="/css/paypogress.css">

    <!----------Style CDN----------->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Roboto:400,500,600,700,800,900&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400&amp;display=swap">
    <script type="text/javascript" async=""
        src="https://www.googletagmanager.com/gtag/js?id=G-BM6XDYQ00R&amp;l=dataLayer&amp;cx=c">
        </script>
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js">
    </script>
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-233699090-1"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">


    <meta name="description" content="not Set---------" data-rh="true">
    <meta property="og:description" content="Not Set--------------" data-rh="true">
    <meta name="twitter:title" content="Not Set---------------" data-rh="true">
    <meta name="twitter:description" content="Not Set----------" data-rh="true">
    <meta name="apple-mobile-web-app-title" content="Not Set-------" data-rh="true">
</head>

<body><noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root">
        <div class="" id="sidenevover"></div>
        <div class="sideNav " id="sidenev"><a class="sideNav-options" href="/profile">
                <picture class="sideNav-icon"><img class="border-50" id="Avatar" src="/images/lodimg.gif" alt="My Profile">
                </picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">My Profile</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/">
                <picture class="sideNav-icon"><img class="" src="/images/gamepad.png" alt="Win Cash"></picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">Win Cash</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/wallet">
                <picture class="sideNav-icon"><img class="" src="/images/sidebar-wallet.png" alt="My Wallet"></picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">My Wallet</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/game-history">
                <picture class="sideNav-icon"><img class="" src="/images/sidebar-gamesHistory.png" alt="Games History">
                </picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">Games History</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/transaction-history">
                <picture class="sideNav-icon"><img class="" src="/images/order-history.png" alt="Transaction History">
                </picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">Transaction History</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/refer-earn">
                <picture class="sideNav-icon"><img class="" src="/images/sidebar-referEarn.png" alt="Refer &amp; Earn">
                </picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">Refer &amp; Earn</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/notification">
                <picture class="sideNav-icon"><img class="" src="/images/sidebar-notifications.png" alt="Notification">
                </picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">Notification</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a><a class="sideNav-options" href="/support">
                <picture class="sideNav-icon"><img class="" src="/images/sidebar-support.png" alt="Support"></picture>
                <div class="position-relative ml-3">
                    <div class="sideNav-text">Support</div>
                </div>
                <picture class="sideNav-arrow"><img src="/images/global-black-chevronRight.png" alt=""></picture>
                <div class="sideNav-divider"></div>
            </a></div>
        <div class="leftContainer">
            <div class="headerContainer"><a onclick="opensidenev()" class="cxy h-100">
                    <picture class="sideNavIcon ml-3 mr-2"><img src="/images/header-hamburger.png" alt=""></picture>
                </a><a href="/">
                    <picture class="ml-2 navLogo d-flex"><img src="/images/khelbro.png" alt=""></picture>
                </a>
                <div>
                    <div class="menu-items"><a class="box" href="/add-funds">
                            <picture class="moneyIcon-container"><img src="/images/global-rupeeIcon.png" alt="">
                            </picture>
                            <div class="mt-1 ml-1">
                                <div class="moneyBox-header">Cash</div>
                                <div class="moneyBox-text" id="wincash">0</div>
                            </div>
                            <picture class="moneyBox-add"><img src="/images/global-addSign.png" alt=""></picture>
                        </a></div><span class="mx-5"></span>
                </div><span class="mx-5"></span>
            </div>
            <div class="main-area" style="padding-top: 60px;">
                <div class="px-4 py-3">
                    






<!-- <button id="trigger">Complete/Reverse (debug)</button> -->
<div id="processing" class="uncomplete center">
	<div class="headings">
		<h1>Payment processing...</h1>
		<h2>Please wait</h2>
	</div>
	<div class="wrapper">
		<div class="gears">
			<div class="gear-wrapper gear-wrapper-1">
				<svg version="1.1" class="gear gear-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
					<path class="st0" d="M507.6,232.1c0,0-9.3-3.5-36.2-6c-32.9-3-42.8-15.4-53.7-30.7h-0.2c-1.4-3.6-2.8-7.2-4.4-10.8l0.1-0.1
		c-3.1-18.6-4.8-34.3,16.3-59.7C446.7,104,450.8,95,450.8,95c-4-10.3-13.8-20-13.8-20s-9.7-9.7-20-13.8c0,0-9.1,4.1-29.8,21.4
		c-25.4,21.1-41.1,19.4-59.7,16.3l-0.1,0.1c-3.5-1.6-7.1-3.1-10.8-4.4v-0.2c-15.3-10.9-27.7-20.9-30.7-53.7c-2.5-26.9-6-36.2-6-36.2
		C269.8,0,256,0,256,0s-13.8,0-23.9,4.4c0,0-3.5,9.3-6,36.2c-3,32.9-15.4,42.8-30.7,53.7v0.2c-3.6,1.4-7.3,2.8-10.8,4.4l-0.1-0.1
		c-18.6,3.1-34.3,4.8-59.7-16.3C104,65.3,95,61.2,95,61.2C84.7,65.3,75,75,75,75s-9.7,9.7-13.8,20c0,0,4.1,9.1,21.4,29.8
		c21.1,25.4,19.4,41.1,16.3,59.7l0.1,0.1c-1.6,3.5-3.1,7.1-4.4,10.8h-0.2c-10.9,15.4-20.9,27.7-53.7,30.7c-26.9,2.5-36.2,6-36.2,6
		C0,242.3,0,256,0,256s0,13.8,4.4,23.9c0,0,9.3,3.5,36.2,6c32.9,3,42.8,15.4,53.7,30.7h0.2c1.4,3.7,2.8,7.3,4.4,10.8l-0.1,0.1
		c3.1,18.6,4.8,34.3-16.3,59.7C65.3,408,61.2,417,61.2,417c4.1,10.3,13.8,20,13.8,20s9.7,9.7,20,13.8c0,0,9-4.1,29.8-21.4
		c25.4-21.1,41.1-19.4,59.7-16.3l0.1-0.1c3.5,1.6,7.1,3.1,10.8,4.4v0.2c15.3,10.9,27.7,20.9,30.7,53.7c2.5,26.9,6,36.2,6,36.2
		C242.3,512,256,512,256,512s13.8,0,23.9-4.4c0,0,3.5-9.3,6-36.2c3-32.9,15.4-42.8,30.7-53.7v-0.2c3.7-1.4,7.3-2.8,10.8-4.4l0.1,0.1
		c18.6-3.1,34.3-4.8,59.7,16.3c20.8,17.3,29.8,21.4,29.8,21.4c10.3-4.1,20-13.8,20-13.8s9.7-9.7,13.8-20c0,0-4.1-9.1-21.4-29.8
		c-21.1-25.4-19.4-41.1-16.3-59.7l-0.1-0.1c1.6-3.5,3.1-7.1,4.4-10.8h0.2c10.9-15.3,20.9-27.7,53.7-30.7c26.9-2.5,36.2-6,36.2-6
		C512,269.8,512,256,512,256S512,242.2,507.6,232.1z M256,375.7c-66.1,0-119.7-53.6-119.7-119.7S189.9,136.3,256,136.3
		c66.1,0,119.7,53.6,119.7,119.7S322.1,375.7,256,375.7z" />
				</svg>
			</div>
			<div class="gear-wrapper gear-wrapper-2">
				<svg version="1.1" class="gear gear-2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
					<path class="st0" d="M507.6,232.1c0,0-9.3-3.5-36.2-6c-32.9-3-42.8-15.4-53.7-30.7h-0.2c-1.4-3.6-2.8-7.2-4.4-10.8l0.1-0.1
		c-3.1-18.6-4.8-34.3,16.3-59.7C446.7,104,450.8,95,450.8,95c-4-10.3-13.8-20-13.8-20s-9.7-9.7-20-13.8c0,0-9.1,4.1-29.8,21.4
		c-25.4,21.1-41.1,19.4-59.7,16.3l-0.1,0.1c-3.5-1.6-7.1-3.1-10.8-4.4v-0.2c-15.3-10.9-27.7-20.9-30.7-53.7c-2.5-26.9-6-36.2-6-36.2
		C269.8,0,256,0,256,0s-13.8,0-23.9,4.4c0,0-3.5,9.3-6,36.2c-3,32.9-15.4,42.8-30.7,53.7v0.2c-3.6,1.4-7.3,2.8-10.8,4.4l-0.1-0.1
		c-18.6,3.1-34.3,4.8-59.7-16.3C104,65.3,95,61.2,95,61.2C84.7,65.3,75,75,75,75s-9.7,9.7-13.8,20c0,0,4.1,9.1,21.4,29.8
		c21.1,25.4,19.4,41.1,16.3,59.7l0.1,0.1c-1.6,3.5-3.1,7.1-4.4,10.8h-0.2c-10.9,15.4-20.9,27.7-53.7,30.7c-26.9,2.5-36.2,6-36.2,6
		C0,242.3,0,256,0,256s0,13.8,4.4,23.9c0,0,9.3,3.5,36.2,6c32.9,3,42.8,15.4,53.7,30.7h0.2c1.4,3.7,2.8,7.3,4.4,10.8l-0.1,0.1
		c3.1,18.6,4.8,34.3-16.3,59.7C65.3,408,61.2,417,61.2,417c4.1,10.3,13.8,20,13.8,20s9.7,9.7,20,13.8c0,0,9-4.1,29.8-21.4
		c25.4-21.1,41.1-19.4,59.7-16.3l0.1-0.1c3.5,1.6,7.1,3.1,10.8,4.4v0.2c15.3,10.9,27.7,20.9,30.7,53.7c2.5,26.9,6,36.2,6,36.2
		C242.3,512,256,512,256,512s13.8,0,23.9-4.4c0,0,3.5-9.3,6-36.2c3-32.9,15.4-42.8,30.7-53.7v-0.2c3.7-1.4,7.3-2.8,10.8-4.4l0.1,0.1
		c18.6-3.1,34.3-4.8,59.7,16.3c20.8,17.3,29.8,21.4,29.8,21.4c10.3-4.1,20-13.8,20-13.8s9.7-9.7,13.8-20c0,0-4.1-9.1-21.4-29.8
		c-21.1-25.4-19.4-41.1-16.3-59.7l-0.1-0.1c1.6-3.5,3.1-7.1,4.4-10.8h0.2c10.9-15.3,20.9-27.7,53.7-30.7c26.9-2.5,36.2-6,36.2-6
		C512,269.8,512,256,512,256S512,242.2,507.6,232.1z M256,375.7c-66.1,0-119.7-53.6-119.7-119.7S189.9,136.3,256,136.3
		c66.1,0,119.7,53.6,119.7,119.7S322.1,375.7,256,375.7z" />
				</svg>
			</div>
			<div class="gear-wrapper gear-wrapper-3">
				<svg version="1.1" class="gear gear-3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
					<path class="st0" d="M507.6,232.1c0,0-9.3-3.5-36.2-6c-32.9-3-42.8-15.4-53.7-30.7h-0.2c-1.4-3.6-2.8-7.2-4.4-10.8l0.1-0.1
		c-3.1-18.6-4.8-34.3,16.3-59.7C446.7,104,450.8,95,450.8,95c-4-10.3-13.8-20-13.8-20s-9.7-9.7-20-13.8c0,0-9.1,4.1-29.8,21.4
		c-25.4,21.1-41.1,19.4-59.7,16.3l-0.1,0.1c-3.5-1.6-7.1-3.1-10.8-4.4v-0.2c-15.3-10.9-27.7-20.9-30.7-53.7c-2.5-26.9-6-36.2-6-36.2
		C269.8,0,256,0,256,0s-13.8,0-23.9,4.4c0,0-3.5,9.3-6,36.2c-3,32.9-15.4,42.8-30.7,53.7v0.2c-3.6,1.4-7.3,2.8-10.8,4.4l-0.1-0.1
		c-18.6,3.1-34.3,4.8-59.7-16.3C104,65.3,95,61.2,95,61.2C84.7,65.3,75,75,75,75s-9.7,9.7-13.8,20c0,0,4.1,9.1,21.4,29.8
		c21.1,25.4,19.4,41.1,16.3,59.7l0.1,0.1c-1.6,3.5-3.1,7.1-4.4,10.8h-0.2c-10.9,15.4-20.9,27.7-53.7,30.7c-26.9,2.5-36.2,6-36.2,6
		C0,242.3,0,256,0,256s0,13.8,4.4,23.9c0,0,9.3,3.5,36.2,6c32.9,3,42.8,15.4,53.7,30.7h0.2c1.4,3.7,2.8,7.3,4.4,10.8l-0.1,0.1
		c3.1,18.6,4.8,34.3-16.3,59.7C65.3,408,61.2,417,61.2,417c4.1,10.3,13.8,20,13.8,20s9.7,9.7,20,13.8c0,0,9-4.1,29.8-21.4
		c25.4-21.1,41.1-19.4,59.7-16.3l0.1-0.1c3.5,1.6,7.1,3.1,10.8,4.4v0.2c15.3,10.9,27.7,20.9,30.7,53.7c2.5,26.9,6,36.2,6,36.2
		C242.3,512,256,512,256,512s13.8,0,23.9-4.4c0,0,3.5-9.3,6-36.2c3-32.9,15.4-42.8,30.7-53.7v-0.2c3.7-1.4,7.3-2.8,10.8-4.4l0.1,0.1
		c18.6-3.1,34.3-4.8,59.7,16.3c20.8,17.3,29.8,21.4,29.8,21.4c10.3-4.1,20-13.8,20-13.8s9.7-9.7,13.8-20c0,0-4.1-9.1-21.4-29.8
		c-21.1-25.4-19.4-41.1-16.3-59.7l-0.1-0.1c1.6-3.5,3.1-7.1,4.4-10.8h0.2c10.9-15.3,20.9-27.7,53.7-30.7c26.9-2.5,36.2-6,36.2-6
		C512,269.8,512,256,512,256S512,242.2,507.6,232.1z M256,375.7c-66.1,0-119.7-53.6-119.7-119.7S189.9,136.3,256,136.3
		c66.1,0,119.7,53.6,119.7,119.7S322.1,375.7,256,375.7z" />
				</svg>
			</div>
			<div class="gear-wrapper gear-wrapper-4">
				<svg version="1.1" class="gear gear-4" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
					<path class="st0" d="M507.6,232.1c0,0-9.3-3.5-36.2-6c-32.9-3-42.8-15.4-53.7-30.7h-0.2c-1.4-3.6-2.8-7.2-4.4-10.8l0.1-0.1
		c-3.1-18.6-4.8-34.3,16.3-59.7C446.7,104,450.8,95,450.8,95c-4-10.3-13.8-20-13.8-20s-9.7-9.7-20-13.8c0,0-9.1,4.1-29.8,21.4
		c-25.4,21.1-41.1,19.4-59.7,16.3l-0.1,0.1c-3.5-1.6-7.1-3.1-10.8-4.4v-0.2c-15.3-10.9-27.7-20.9-30.7-53.7c-2.5-26.9-6-36.2-6-36.2
		C269.8,0,256,0,256,0s-13.8,0-23.9,4.4c0,0-3.5,9.3-6,36.2c-3,32.9-15.4,42.8-30.7,53.7v0.2c-3.6,1.4-7.3,2.8-10.8,4.4l-0.1-0.1
		c-18.6,3.1-34.3,4.8-59.7-16.3C104,65.3,95,61.2,95,61.2C84.7,65.3,75,75,75,75s-9.7,9.7-13.8,20c0,0,4.1,9.1,21.4,29.8
		c21.1,25.4,19.4,41.1,16.3,59.7l0.1,0.1c-1.6,3.5-3.1,7.1-4.4,10.8h-0.2c-10.9,15.4-20.9,27.7-53.7,30.7c-26.9,2.5-36.2,6-36.2,6
		C0,242.3,0,256,0,256s0,13.8,4.4,23.9c0,0,9.3,3.5,36.2,6c32.9,3,42.8,15.4,53.7,30.7h0.2c1.4,3.7,2.8,7.3,4.4,10.8l-0.1,0.1
		c3.1,18.6,4.8,34.3-16.3,59.7C65.3,408,61.2,417,61.2,417c4.1,10.3,13.8,20,13.8,20s9.7,9.7,20,13.8c0,0,9-4.1,29.8-21.4
		c25.4-21.1,41.1-19.4,59.7-16.3l0.1-0.1c3.5,1.6,7.1,3.1,10.8,4.4v0.2c15.3,10.9,27.7,20.9,30.7,53.7c2.5,26.9,6,36.2,6,36.2
		C242.3,512,256,512,256,512s13.8,0,23.9-4.4c0,0,3.5-9.3,6-36.2c3-32.9,15.4-42.8,30.7-53.7v-0.2c3.7-1.4,7.3-2.8,10.8-4.4l0.1,0.1
		c18.6-3.1,34.3-4.8,59.7,16.3c20.8,17.3,29.8,21.4,29.8,21.4c10.3-4.1,20-13.8,20-13.8s9.7-9.7,13.8-20c0,0-4.1-9.1-21.4-29.8
		c-21.1-25.4-19.4-41.1-16.3-59.7l-0.1-0.1c1.6-3.5,3.1-7.1,4.4-10.8h0.2c10.9-15.3,20.9-27.7,53.7-30.7c26.9-2.5,36.2-6,36.2-6
		C512,269.8,512,256,512,256S512,242.2,507.6,232.1z M256,375.7c-66.1,0-119.7-53.6-119.7-119.7S189.9,136.3,256,136.3
		c66.1,0,119.7,53.6,119.7,119.7S322.1,375.7,256,375.7z" />
				</svg>
			</div>
		</div>
		<div class="loading-bar" data-progress="0"><span></span></div>
		<svg class="checkmark checkmark-success" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
			<circle class="checkmark-circle" cx="25" cy="25" r="25" fill="none" />
			<path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" />
		</svg>
	</div>
</div>





                    </div>
            
            </div>
        </div>
        <div class="divider-y"></div>
        <div class="rightContainer">
            <div class="rcBanner flex-center">
                <picture class="rcBanner-img-container"><img src="/images/khelbro.png" alt=""></picture>
                <div class="rcBanner-text">Khel Bro <span class="rcBanner-text-bold">Win Real Cash!</span></div>
                <div class="rcBanner-footer">For best experience, open&nbsp;<a href="#!"
                        style="color: rgb(44, 44, 44); font-weight: 500; text-decoration: none;">KhelBro.com</a>&nbsp;on&nbsp;<img
                        src="/images/global-chrome.png" alt="">&nbsp;chrome mobile</div>
            </div>
        </div>
    </div>
 
 
 <?php if ($_SERVER["REQUEST_METHOD"] == "POST") { ?>
    
    <?php }
          else{ ?>
     <script> location.replace("/add-funds") </script>
     <?php     } ?>

     
<?php
require('config.php');
require('razorpay-php/Razorpay.php');
session_start();

// Create the Razorpay Order

use Razorpay\Api\Api;

$api = new Api($keyId, $keySecret);

//
// We create an razorpay order using orders api
// Docs: https://docs.razorpay.com/docs/orders
//
$price = $_POST['cashAmount'];
$_SESSION['price'] = $price;
$orderData = [
    'receipt'         => 3456,
    'amount'          => $price * 100, // 2000 rupees in paise
    'currency'        => 'INR',
    'payment_capture' => 1 // auto capture
];

$razorpayOrder = $api->order->create($orderData);

$razorpayOrderId = $razorpayOrder['id'];

$_SESSION['razorpay_order_id'] = $razorpayOrderId;

$displayAmount = $amount = $orderData['amount'];

if ($displayCurrency !== 'INR')
{
    $url = "https://api.fixer.io/latest?symbols=$displayCurrency&base=INR";
    $exchange = json_decode(file_get_contents($url), true);

    $displayAmount = $exchange['rates'][$displayCurrency] * $amount / 100;
}

$data = [
    "key"               => $keyId,
    "amount"            => $amount,
    "name"              => "GamesClass",
    "description"       => "Coding for Everyone",
    "image"             => "https://s29.postimg.org/r6dj1g85z/daft_punk.jpg",
    "prefill"           => [
    ],
    "notes"             => [
    "address"           => "Hello World",
    "merchant_order_id" => "12312321",
    ],
    "theme"             => [
    "color"             => "#F37254"
    ],
    "order_id"          => $razorpayOrderId,
];

if ($displayCurrency !== 'INR')
{
    $data['display_currency']  = $displayCurrency;
    $data['display_amount']    = $displayAmount;
}

$json = json_encode($data);
?>


 

<script src="/js/jquery.min.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="/js/localforage.min.js"></script>
    <script src="/js/firebase.js"></script>
    <script src="/js/firebasesdk.js"></script>
    <script src="/js/main.js"></script>
<script>
    function usercheck(){
    localforage.getItem("userlogindata").then((data)=>{
    if(data==true){
    }
    else{
     window.location.href = "/login";
    };
    })};
    localforage.getItem("Avatar").then((data)=>{
                document.getElementById("Avatar").src = "/avatar/"+data;
                });
  localforage.getItem("Wincash").then((data)=>{
  var Wincash = data;
    addDiposit(Wincash);
    });
 function addDiposit(Wincash){
localforage.getItem("DepositCash").then((data)=>{
    document.getElementById("wincash").innerHTML = Math.floor(+Wincash+data);
 })};

 ////////////////////Payment Section
var options = {
        "key": "<?php echo $data['key']?>", // Enter the Key ID generated from the Dashboard
        "amount": "<?php echo $data['amount']?>", // Amount is in currency subunits. Default currency is INR. Hence, 50000 means 50000 paise or â‚¹500.
        "currency": "INR",
        "name": "<?php echo $data['name']?>",
        "description": "Tutorial",
        "image": "/images/logo.png",
        "order_id": "<?php echo $data['order_id']?>",
        "handler": function (response){
            savetoDB(response);
        },
        "prefill": {
            "name": "Lokus",
            "email": "",
            "contact": ""
        },
        "notes": {
            "address": "note value"
        },
        "theme": {
            "color": "#33B5FF"
        }
    }
    var propay = new Razorpay(options);
    propay.open();

    function savetoDB(response) {
    console.log(response);
localforage.getItem("UserID").then((data)=>{
    var UserID = data;
    var RED = firebase.database().ref("Admin").child('RazorpayProcess');
    RED.on('value', function(snapshot) {
    var Reddata = (snapshot.val());
    if(Reddata=="Auto"){
        savetoDBAuto(response, UserID);
    }
    else{
        savetoDBManual(response, UserID)
    
    }
    });
})};

////////////////////Auto Pocess///////////
function savetoDBAuto(response, UserID){
    localforage.getItem("Username").then((data)=>{   
        var payment_id = response.razorpay_payment_id;
        var cashAmount = "<?php echo $data['amount']?>"/100;
        ms = Date.now();
        firebase.database().ref("Transaction/"+payment_id).update({
            PaymentID : payment_id,
            UserID : UserID,
            UserName : data,
            Amount : cashAmount,
            Type: "Deposit",
            Through : "using Razorpay",
            Symbol: "(+)",
            Ms : ms,
            Month : Month,
            Date : Dates,
            Time : strTime,
            Status : 'Complite'
        
        
        },userCashUpdate);
        });
};

function userCashUpdate(){
    localforage.getItem("UserID").then((data)=>{
        var Amount = +"<?php echo $data['amount']?>"/100;
        const pointRef = firebase.database().ref("User/"+data);
        pointRef.once("value").then((snapshot) => {
          pointRef.update({DEPOSITCASH: +snapshot.val().DEPOSITCASH+Amount},CompliteDiposit).then(() => {
          });
        });
    });
}

///////////////Manual Process/////////////
function  savetoDBManual(response, UserID){
localforage.getItem("Username").then((data)=>{   
var payment_id = response.razorpay_payment_id;
var cashAmount = "<?php echo $data['amount']?>"/100;
ms = Date.now();
firebase.database().ref("Transaction/"+payment_id).update({
    PaymentID : payment_id,
    UserID : UserID,
    UserName : data,
    Amount : cashAmount,
    Type: "Deposit",
    Through : "using Razorpay",
    Symbol: "(+)",
    Ms : ms,
    Month : Month,
    Date : Dates,
    Time : strTime,
    Status : 'Pending'


},CompliteDiposit);

});};

function CompliteDiposit(){
    $("#processing").removeClass("uncomplete").addClass("complete");

    setTimeout(function() {
      window.location.href = "/transaction-history/"
  }, 3000);
};


/////Sidebar open
var sidebar = document.getElementById("sidenev");
 var sideover = document.getElementById("sidenevover");
 function opensidenev(){
sidebar.classList.add("sideNav-open");
sideover.classList.add("sideNav-overlay");
 };

 /////Sidebar Hide
 
 window.onclick = function(event) {
    if (event.target == sideover) {
        sidebar.classList.remove("sideNav-open");
        sideover.classList.remove("sideNav-overlay");
    }
  }
  </script>
  <!-- Any extra fields to be submitted with the form but not sent to Razorpay -->
  
  </body>

</html>